
Yelp Reviews Preprocess for Warehouse Construction
======================================================================

Summary of Yelp Reviews Data



Reviews - Data Summary


Number of Rows: 8635403, Columns: 9
             Number of Unique Values  Number of Missing Values  \
review_id                    8635403                         0   
user_id                      2189457                         0   
business_id                   160585                         0   
stars                              5                         0   
useful                           233                         0   
funny                            190                         0   
cool                             207                         0   
text                         8616410                         0   
date                         8485984                         0   

            Data type of variable  
review_id                  object  
user_id                    object  
business_id                object  
stars                       int64  
useful                      int64  
funny                       int64  
cool                        int64  
text                       object  
date               datetime64[ns]  
None
======================================================================

Business - Data Summary


Number of Rows: 160585, Columns: 14
              Number of Unique Values  Number of Missing Values  \
business_id                    160585                         0   
name                           125850                         0   
address                        123895                         0   
city                              836                         0   
state                              31                         0   
postal_code                      5779                         0   
latitude                       137397                         0   
longitude                      133643                         0   
stars                               9                         0   
review_count                     1281                         0   
is_open                             2                         0   
attributes                      90475                         0   
categories                      88115                       115   
hours                           50858                         0   

             Data type of variable  
business_id                 object  
name                        object  
address                     object  
city                        object  
state                       object  
postal_code                 object  
latitude                   float64  
longitude                  float64  
stars                      float64  
review_count                 int64  
is_open                      int64  
attributes                  object  
categories                  object  
hours                       object  
None
======================================================================

User - Data Summary


Number of Rows: 2189457, Columns: 22
                    Number of Unique Values  Number of Missing Values  \
user_id                             2189457                         0   
name                                 153611                         0   
review_count                           1917                         0   
yelping_since                       2179957                         0   
useful                                 5204                         0   
funny                                  3680                         0   
cool                                   4381                         0   
elite                                  1235                         0   
friends                             1212599                         0   
fans                                    680                         0   
average_stars                           401                         0   
compliment_hot                         1318                         0   
compliment_more                         350                         0   
compliment_profile                      347                         0   
compliment_cute                         317                         0   
compliment_list                         191                         0   
compliment_note                         965                         0   
compliment_plain                       1644                         0   
compliment_cool                        1581                         0   
compliment_funny                       1581                         0   
compliment_writer                       822                         0   
compliment_photos                       952                         0   

                   Data type of variable  
user_id                           object  
name                              object  
review_count                       int64  
yelping_since                     object  
useful                             int64  
funny                              int64  
cool                               int64  
elite                             object  
friends                           object  
fans                               int64  
average_stars                    float64  
compliment_hot                     int64  
compliment_more                    int64  
compliment_profile                 int64  
compliment_cute                    int64  
compliment_list                    int64  
compliment_note                    int64  
compliment_plain                   int64  
compliment_cool                    int64  
compliment_funny                   int64  
compliment_writer                  int64  
compliment_photos                  int64  
None
======================================================================

Tip - Data Summary


Number of Rows: 1161995, Columns: 5
                  Number of Unique Values  Number of Missing Values  \
user_id                            339244                         0   
business_id                        110915                         0   
text                              1090182                         0   
date                              1158473                         0   
compliment_count                       11                         0   

                 Data type of variable  
user_id                         object  
business_id                     object  
text                            object  
date                    datetime64[ns]  
compliment_count                 int64  
None
======================================================================

Checkin - Data Summary


Number of Rows: 138876, Columns: 2
             Number of Unique Values  Number of Missing Values  \
business_id                   138876                         0   
date                          138875                         0   

            Data type of variable  
business_id                object  
date                       object  
None
======================================================================

Process Yelp Review and Business for data warehouse construction:
Sample observations from Reviews:
                review_id                 user_id             business_id  \
0  lWC-xP3rd6obsecCYsGZRg  ak0TdVmGKo4pwqdJSTLwWw  buF9druCkbuXLX526sGELQ   
1  8bFej1QE5LXp4O05qjGqXA  YoVfDbnISlW0f7abNQACIg  RA4V8pr014UyUbDvI-LW2A   
2  NDhkzczKjLshODbqDoNLSg  eC5evKn1TWDyHCyQAwguUw  _sS2LBIGNT5NQb6PD1Vtjw   
3  T5fAqjjFooT4V0OeZyuk1w  SFQ1jcnGguO0LYWnbbftAA  0AzLzHfOJgL7ROwhdww2ew   
4  sjm_uUcQVxab_EeLCqsYLg  0kA0PAJ8QFMeveQWHFqz2A  8zehGz9jnxPqXtOc7KaJxA   

   stars_reviews  useful_reviews  funny_reviews  cool_reviews  \
0              4               3              1             1   
1              4               1              0             0   
2              5               0              0             0   
3              2               1              1             1   
4              4               0              0             0   

                                        text_reviews        date_reviews  
0  Apparently Prides Osteria had a rough summer a... 2014-10-11 03:34:02  
1  This store is pretty good. Not as great as Wal... 2015-07-03 20:38:25  
2  I called WVM on the recommendation of a couple... 2013-05-28 20:38:06  
3  I've stayed at many Marriott and Renaissance M... 2010-01-08 02:29:15  
4  The food is always great here. The service fro... 2011-07-28 18:05:01  


Sample observations from Businesses:
              business_id            name_business              address  \
0  6iYb2HFDywm3zjuRg0shjw      Oskar Blues Taproom         921 Pearl St   
1  tCbdrRPZA0oiIYSmHG3J0w  Flying Elephants at PDX  7000 NE Airport Way   
2  bvN78flM8NLprQ1a1y5dRg           The Reclaimory   4720 Hawthorne Ave   
3  oaepsyvc0J17qwi8cfrOWg              Great Clips   2566 Enterprise Rd   
4  PE9uqAjdw0E4-8mjGl3wVA        Crossfit Terminus  1046 Memorial Dr SE   

          city state postal_code   latitude   longitude  stars_business  \
0      Boulder    CO       80302  40.017544 -105.283348             4.0   
1     Portland    OR       97218  45.588906 -122.593331             4.0   
2     Portland    OR       97214  45.511907 -122.613693             4.5   
3  Orange City    FL       32763  28.914482  -81.295979             3.0   
4      Atlanta    GA       30316  33.747027  -84.353424             4.0   

   review_countbusiness  is_open  \
0                    86        1   
1                   126        1   
2                    13        1   
3                     8        1   
4                    14        1   

                                 attributes_business  \
0  {'RestaurantsTableService': 'True', 'WiFi': "u...   
1  {'RestaurantsTakeOut': 'True', 'RestaurantsAtt...   
2  {'BusinessAcceptsCreditCards': 'True', 'Restau...   
3  {'RestaurantsPriceRange2': '1', 'BusinessAccep...   
4  {'GoodForKids': 'False', 'BusinessParking': "{...   

                                 categories_business  \
0  Gastropubs, Food, Beer Gardens, Restaurants, B...   
1  Salad, Soup, Sandwiches, Delis, Restaurants, C...   
2  Antiques, Fashion, Used, Vintage & Consignment...   
3                         Beauty & Spas, Hair Salons   
4  Gyms, Active Life, Interval Training Gyms, Fit...   

                                      hours_business  
0  {'Monday': '11:0-23:0', 'Tuesday': '11:0-23:0'...  
1  {'Monday': '5:0-18:0', 'Tuesday': '5:0-17:0', ...  
2  {'Thursday': '11:0-18:0', 'Friday': '11:0-18:0...  
3                                               None  
4  {'Monday': '16:0-19:0', 'Tuesday': '16:0-19:0'...  

Summary - Reviews joined with Business:
Number of Rows: 8634506, Columns: 22
                      Number of Unique Values  Number of Missing Values  \
review_id                             8634506                         0   
user_id                               2189158                         0   
business_id                            160470                         0   
stars_reviews                               5                         0   
useful_reviews                            233                         0   
funny_reviews                             190                         0   
cool_reviews                              207                         0   
text_reviews                          8615518                         0   
date_reviews                          8485121                         0   
name_business                          125752                         0   
address                                123812                         0   
city                                      835                         0   
state                                      31                         0   
postal_code                              5777                         0   
latitude                               137322                         0   
longitude                              133580                         0   
stars_business                              9                         0   
review_countbusiness                     1281                         0   
is_open                                     2                         0   
attributes_business                     90475                         0   
categories_business                     88115                         0   
hours_business                          50858                         0   

                     Data type of variable  
review_id                           object  
user_id                             object  
business_id                         object  
stars_reviews                        int64  
useful_reviews                       int64  
funny_reviews                        int64  
cool_reviews                         int64  
text_reviews                        object  
date_reviews                datetime64[ns]  
name_business                       object  
address                             object  
city                                object  
state                               object  
postal_code                         object  
latitude                           float64  
longitude                          float64  
stars_business                     float64  
review_countbusiness                 int64  
is_open                              int64  
attributes_business                 object  
categories_business                 object  
hours_business                      object  
None
======================================================================

Process Yelp User for data warehouse construction:
Sample observations from Users:
                  user_id  review_count_user   yelping_since_user  \
0  q_QQ5kBBwlCcbL1s4NVK3g               1220  2005-03-14 20:26:35   
1  dIIKEfOgo0KqUfGQvGikPg               2136  2007-08-10 19:01:51   
2  D6ErcUnFALnCQN4b1W_TlA                119  2007-02-07 15:47:53   
3  JnPIjvC0cmooNDfsa9BmXg                987  2009-02-09 16:14:29   
4  37Hc8hr3cw0iHLoPzLK6Ow                495  2008-03-03 04:57:05   

   useful_user  funny_user  cool_user  \
0        15038       10030      11291   
1        21272       10289      18046   
2          188         128        130   
3         7234        4722       4035   
4         1577         727       1124   

                                          elite_user  average_stars_user  \
0       2006,2007,2008,2009,2010,2011,2012,2013,2014                3.85   
1  2007,2008,2009,2010,2011,2012,2013,2014,2015,2...                4.09   
2                                          2010,2011                3.76   
3                      2009,2010,2011,2012,2013,2014                3.77   
4                                     2009,2010,2011                3.72   

   compliment_hot_user  compliment_more_user  compliment_profile_user  \
0                 1710                   163                      190   
1                 1632                    87                       94   
2                   22                     1                        3   
3                 1180                   129                       93   
4                  248                    19                       32   

   compliment_cute_user  compliment_list_user  compliment_note_user  \
0                   361                   147                  1212   
1                   232                    96                  1187   
2                     0                     0                     5   
3                   219                    90                  1120   
4                    16                    15                    77   

   compliment_plain_user  compliment_cool_user  compliment_funny_user  \
0                   5691                  2541                   2541   
1                   3293                  2205                   2205   
2                     20                    31                     31   
3                   4510                  1566                   1566   
4                    131                   310                    310   

   compliment_writer_user  
0                     815  
1                     472  
2                       3  
3                     391  
4                      98  

Summary - Reviews + Business joined with User:
Number of Rows: 8634506, Columns: 39
                         Number of Unique Values  Number of Missing Values  \
review_id                                8634506                         0   
user_id                                  2189158                         0   
business_id                               160470                         0   
stars_reviews                                  5                         0   
useful_reviews                               233                         0   
funny_reviews                                190                         0   
cool_reviews                                 207                         0   
text_reviews                             8615518                         0   
date_reviews                             8485121                         0   
name_business                             125752                         0   
address                                   123812                         0   
city                                         835                         0   
state                                         31                         0   
postal_code                                 5777                         0   
latitude                                  137322                         0   
longitude                                 133580                         0   
stars_business                                 9                         0   
review_countbusiness                        1281                         0   
is_open                                        2                         0   
attributes_business                        90475                         0   
categories_business                        88115                         0   
hours_business                             50858                         0   
review_count_user                           1917                         0   
yelping_since_user                       2179664                         0   
useful_user                                 5204                         0   
funny_user                                  3680                         0   
cool_user                                   4381                         0   
elite_user                                  1235                         0   
average_stars_user                           401                         0   
compliment_hot_user                         1318                         0   
compliment_more_user                         350                         0   
compliment_profile_user                      347                         0   
compliment_cute_user                         317                         0   
compliment_list_user                         191                         0   
compliment_note_user                         965                         0   
compliment_plain_user                       1644                         0   
compliment_cool_user                        1581                         0   
compliment_funny_user                       1581                         0   
compliment_writer_user                       822                         0   

                        Data type of variable  
review_id                              object  
user_id                                object  
business_id                            object  
stars_reviews                           int64  
useful_reviews                          int64  
funny_reviews                           int64  
cool_reviews                            int64  
text_reviews                           object  
date_reviews                   datetime64[ns]  
name_business                          object  
address                                object  
city                                   object  
state                                  object  
postal_code                            object  
latitude                              float64  
longitude                             float64  
stars_business                        float64  
review_countbusiness                    int64  
is_open                                 int64  
attributes_business                    object  
categories_business                    object  
hours_business                         object  
review_count_user                       int64  
yelping_since_user                     object  
useful_user                             int64  
funny_user                              int64  
cool_user                               int64  
elite_user                             object  
average_stars_user                    float64  
compliment_hot_user                     int64  
compliment_more_user                    int64  
compliment_profile_user                 int64  
compliment_cute_user                    int64  
compliment_list_user                    int64  
compliment_note_user                    int64  
compliment_plain_user                   int64  
compliment_cool_user                    int64  
compliment_funny_user                   int64  
compliment_writer_user                  int64  
None
======================================================================

Process Yelp Tip for data warehouse construction:
Number of Rows: 1161932, Columns: 5
                            Number of Unique Values  Number of Missing Values  \
business_id                                  110886                         0   
date_tip                                    1158429                         0   
compliment_count_tip                             11                         0   
name_business                                 83810                         0   
compliment_count_tip_idSum                       23                         0   

                           Data type of variable  
business_id                               object  
date_tip                          datetime64[ns]  
compliment_count_tip                       int64  
name_business                             object  
compliment_count_tip_idSum                 int64  
None

Summary - Tip after Compliment Count Sums:
Number of Rows: 110886, Columns: 4
                                  Number of Unique Values  \
business_id                                        110886   
name_business                                       83810   
compliment_count_tip_idSum                             23   
compliment_count_tip_businessSum                       27   

                                  Number of Missing Values  \
business_id                                              0   
name_business                                            0   
compliment_count_tip_idSum                               0   
compliment_count_tip_businessSum                         0   

                                 Data type of variable  
business_id                                     object  
name_business                                   object  
compliment_count_tip_idSum                       int64  
compliment_count_tip_businessSum                 int64  
None
======================================================================
======================================================================

Process Yelp Checkins for data warehouse construction:
Sample observations from Checkins:
              business_id                                               date
0  --0r8K_AQ4FZfLsX3ZYRDA                                2017-09-03 17:13:59
1  --0zrn43LEaB4jUWTQH_Bg  2010-10-08 22:21:20, 2010-11-01 21:29:14, 2010...
2  --164t1nclzzmca7eDiJMw  2010-02-26 02:06:53, 2010-02-27 08:00:09, 2010...
3  --2aF9NhXnNVpDV0KS3xBQ  2014-11-03 16:35:35, 2015-01-30 18:16:03, 2015...
4  --2mEJ63SC_8_08_jGgVIg  2010-12-15 17:10:46, 2013-12-28 00:27:54, 2015...


              business_id  businessCheckin_date
0  --0r8K_AQ4FZfLsX3ZYRDA   2017-09-03 17:13:59
1  --0zrn43LEaB4jUWTQH_Bg   2010-10-08 22:21:20
2  --0zrn43LEaB4jUWTQH_Bg   2010-11-01 21:29:14
3  --0zrn43LEaB4jUWTQH_Bg   2010-12-23 22:55:45
4  --0zrn43LEaB4jUWTQH_Bg   2011-04-08 17:14:59
              business_id businessCheckin_date  businessCheckin_Year  \
0  --0r8K_AQ4FZfLsX3ZYRDA  2017-09-03 17:13:59                  2017   
1  --0zrn43LEaB4jUWTQH_Bg  2010-10-08 22:21:20                  2010   
2  --0zrn43LEaB4jUWTQH_Bg  2010-11-01 21:29:14                  2010   
3  --0zrn43LEaB4jUWTQH_Bg  2010-12-23 22:55:45                  2010   
4  --0zrn43LEaB4jUWTQH_Bg  2011-04-08 17:14:59                  2011   

  businessCheckin_YearMonth businessCheckin_YearWeek  \
0                   2017-09                 2017-w36   
1                   2010-10                 2010-w40   
2                   2010-11                 2010-w44   
3                   2010-12                 2010-w51   
4                   2011-04                 2011-w14   

  businessCheckin_hourNumber  
0                         PM  
1                         PM  
2                         PM  
3                         PM  
4                         PM  

Summary - Reviews + Business + User + Tip joined with Checkin:
Number of Rows: 7952263, Columns: 46
                                  Number of Unique Values  \
review_id                                         7952263   
user_id                                           2032516   
business_id                                        106642   
stars_reviews                                           5   
useful_reviews                                        229   
funny_reviews                                         189   
cool_reviews                                          206   
text_reviews                                      7935287   
date_reviews                                      7825308   
name_business                                       79920   
address                                             86334   
city                                                  623   
state                                                  21   
postal_code                                          4667   
latitude                                            96789   
longitude                                           95020   
stars_business                                          9   
review_countbusiness                                 1281   
is_open                                                 2   
attributes_business                                 75159   
categories_business                                 61875   
hours_business                                      38206   
review_count_user                                    1917   
yelping_since_user                                2024363   
useful_user                                          5184   
funny_user                                           3666   
cool_user                                            4363   
elite_user                                           1227   
average_stars_user                                    401   
compliment_hot_user                                  1311   
compliment_more_user                                  349   
compliment_profile_user                               345   
compliment_cute_user                                  315   
compliment_list_user                                  190   
compliment_note_user                                  959   
compliment_plain_user                                1638   
compliment_cool_user                                 1575   
compliment_funny_user                                1575   
compliment_writer_user                                818   
compliment_count_tip_idSum                             23   
compliment_count_tip_businessSum                       27   
businessCheckin_date                               106642   
dateDay_checkinSum                                   2683   
dateYear_checkinSum                                  2683   
dateYearMonth_checkinSum                             2683   
dateYearWeek_checkinSum                              2683   

                                  Number of Missing Values  \
review_id                                                0   
user_id                                                  0   
business_id                                              0   
stars_reviews                                            0   
useful_reviews                                           0   
funny_reviews                                            0   
cool_reviews                                             0   
text_reviews                                             0   
date_reviews                                             0   
name_business                                            0   
address                                                  0   
city                                                     0   
state                                                    0   
postal_code                                              0   
latitude                                                 0   
longitude                                                0   
stars_business                                           0   
review_countbusiness                                     0   
is_open                                                  0   
attributes_business                                      0   
categories_business                                      0   
hours_business                                           0   
review_count_user                                        0   
yelping_since_user                                       0   
useful_user                                              0   
funny_user                                               0   
cool_user                                                0   
elite_user                                               0   
average_stars_user                                       0   
compliment_hot_user                                      0   
compliment_more_user                                     0   
compliment_profile_user                                  0   
compliment_cute_user                                     0   
compliment_list_user                                     0   
compliment_note_user                                     0   
compliment_plain_user                                    0   
compliment_cool_user                                     0   
compliment_funny_user                                    0   
compliment_writer_user                                   0   
compliment_count_tip_idSum                               0   
compliment_count_tip_businessSum                         0   
businessCheckin_date                                     0   
dateDay_checkinSum                                       0   
dateYear_checkinSum                                      0   
dateYearMonth_checkinSum                                 0   
dateYearWeek_checkinSum                                  0   

                                 Data type of variable  
review_id                                       object  
user_id                                         object  
business_id                                     object  
stars_reviews                                    int64  
useful_reviews                                   int64  
funny_reviews                                    int64  
cool_reviews                                     int64  
text_reviews                                    object  
date_reviews                            datetime64[ns]  
name_business                                   object  
address                                         object  
city                                            object  
state                                           object  
postal_code                                     object  
latitude                                       float64  
longitude                                      float64  
stars_business                                 float64  
review_countbusiness                             int64  
is_open                                          int64  
attributes_business                             object  
categories_business                             object  
hours_business                                  object  
review_count_user                                int64  
yelping_since_user                              object  
useful_user                                      int64  
funny_user                                       int64  
cool_user                                        int64  
elite_user                                      object  
average_stars_user                             float64  
compliment_hot_user                              int64  
compliment_more_user                             int64  
compliment_profile_user                          int64  
compliment_cute_user                             int64  
compliment_list_user                             int64  
compliment_note_user                             int64  
compliment_plain_user                            int64  
compliment_cool_user                             int64  
compliment_funny_user                            int64  
compliment_writer_user                           int64  
compliment_count_tip_idSum                       int64  
compliment_count_tip_businessSum                 int64  
businessCheckin_date                            object  
dateDay_checkinSum                             float64  
dateYear_checkinSum                            float64  
dateYearMonth_checkinSum                       float64  
dateYearWeek_checkinSum                        float64  
None
======================================================================

Summary - Complete Cases of Reviews + Business + User + Tip + Checkin:
Number of Rows: 7952263, Columns: 46
                                  Number of Unique Values  \
review_id                                         7952263   
user_id                                           2032516   
business_id                                        106642   
stars_reviews                                           5   
useful_reviews                                        229   
funny_reviews                                         189   
cool_reviews                                          206   
text_reviews                                      7935287   
date_reviews                                      7825308   
name_business                                       79920   
address                                             86334   
city                                                  623   
state                                                  21   
postal_code                                          4667   
latitude                                            96789   
longitude                                           95020   
stars_business                                          9   
review_countbusiness                                 1281   
is_open                                                 2   
attributes_business                                 75159   
categories_business                                 61875   
hours_business                                      38206   
review_count_user                                    1917   
yelping_since_user                                2024363   
useful_user                                          5184   
funny_user                                           3666   
cool_user                                            4363   
elite_user                                           1227   
average_stars_user                                    401   
compliment_hot_user                                  1311   
compliment_more_user                                  349   
compliment_profile_user                               345   
compliment_cute_user                                  315   
compliment_list_user                                  190   
compliment_note_user                                  959   
compliment_plain_user                                1638   
compliment_cool_user                                 1575   
compliment_funny_user                                1575   
compliment_writer_user                                818   
compliment_count_tip_idSum                             23   
compliment_count_tip_businessSum                       27   
businessCheckin_date                               106642   
dateDay_checkinSum                                   2683   
dateYear_checkinSum                                  2683   
dateYearMonth_checkinSum                             2683   
dateYearWeek_checkinSum                              2683   

                                  Number of Missing Values  \
review_id                                                0   
user_id                                                  0   
business_id                                              0   
stars_reviews                                            0   
useful_reviews                                           0   
funny_reviews                                            0   
cool_reviews                                             0   
text_reviews                                             0   
date_reviews                                             0   
name_business                                            0   
address                                                  0   
city                                                     0   
state                                                    0   
postal_code                                              0   
latitude                                                 0   
longitude                                                0   
stars_business                                           0   
review_countbusiness                                     0   
is_open                                                  0   
attributes_business                                      0   
categories_business                                      0   
hours_business                                           0   
review_count_user                                        0   
yelping_since_user                                       0   
useful_user                                              0   
funny_user                                               0   
cool_user                                                0   
elite_user                                               0   
average_stars_user                                       0   
compliment_hot_user                                      0   
compliment_more_user                                     0   
compliment_profile_user                                  0   
compliment_cute_user                                     0   
compliment_list_user                                     0   
compliment_note_user                                     0   
compliment_plain_user                                    0   
compliment_cool_user                                     0   
compliment_funny_user                                    0   
compliment_writer_user                                   0   
compliment_count_tip_idSum                               0   
compliment_count_tip_businessSum                         0   
businessCheckin_date                                     0   
dateDay_checkinSum                                       0   
dateYear_checkinSum                                      0   
dateYearMonth_checkinSum                                 0   
dateYearWeek_checkinSum                                  0   

                                 Data type of variable  
review_id                                       object  
user_id                                         object  
business_id                                     object  
stars_reviews                                    int64  
useful_reviews                                   int64  
funny_reviews                                    int64  
cool_reviews                                     int64  
text_reviews                                    object  
date_reviews                            datetime64[ns]  
name_business                                   object  
address                                         object  
city                                            object  
state                                           object  
postal_code                                     object  
latitude                                       float64  
longitude                                      float64  
stars_business                                 float64  
review_countbusiness                             int64  
is_open                                          int64  
attributes_business                             object  
categories_business                             object  
hours_business                                  object  
review_count_user                                int64  
yelping_since_user                              object  
useful_user                                      int64  
funny_user                                       int64  
cool_user                                        int64  
elite_user                                      object  
average_stars_user                             float64  
compliment_hot_user                              int64  
compliment_more_user                             int64  
compliment_profile_user                          int64  
compliment_cute_user                             int64  
compliment_list_user                             int64  
compliment_note_user                             int64  
compliment_plain_user                            int64  
compliment_cool_user                             int64  
compliment_funny_user                            int64  
compliment_writer_user                           int64  
compliment_count_tip_idSum                       int64  
compliment_count_tip_businessSum                 int64  
businessCheckin_date                            object  
dateDay_checkinSum                             float64  
dateYear_checkinSum                            float64  
dateYearMonth_checkinSum                       float64  
dateYearWeek_checkinSum                        float64  
None
======================================================================

Dimensions of Exploded Business Open/Closed Days/Hours: (598201, 3)
======================================================================

Number of Unique business hours after removing Regex characteristics: hours_business    9183
dtype: int64
======================================================================


Sample observations from Business Hours:
                              hours_businessOriginal             business_id  \
0  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
1  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
2  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
3  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
4  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   

       hours_business  
0     Monday: 0:0-0:0  
1    Tuesday: 0:0-0:0  
2  Wednesday: 0:0-0:0  
3   Thursday: 0:0-0:0  
4     Friday: 0:0-0:0  

Dimensions of businesses with no open/closed hours: (582121, 3)
======================================================================

Dimensions of businesses with open hours at Midnight: (42394, 7)
======================================================================

Dimensions of businesses with non whole open hours: (539727, 7)
======================================================================

Dimensions of businesses with no open/closed hours: (16080, 7)
======================================================================

Dimensions of businesses with no & business hours open modified: (598201, 7)
======================================================================
              hours_business hoursBusiness_day hours_working  \
598196    Tuesday: 10:0-20:0           Tuesday     10:0-20:0   
598197  Wednesday: 10:0-20:0         Wednesday     10:0-20:0   
598198   Thursday: 10:0-20:0          Thursday     10:0-20:0   
598199     Friday: 10:0-20:0            Friday     10:0-20:0   
598200   Saturday: 10:0-18:0          Saturday     10:0-18:0   

       hours_businessOpen hours_businessOpen2  
598196               10:0                10.0  
598197               10:0                10.0  
598198               10:0                10.0  
598199               10:0                10.0  
598200               10:0                10.0  

Dimensions of businesses with closing times that are midnight and whole hours: (63313, 9)
======================================================================
- Dimensions of businesses with closing times that are midnight and non whole hours: (995, 9)
======================================================================
- Dimensions of businesses with closing times that are non midnight and whole hours: (455785, 9)
======================================================================
- Dimensions of businesses with closing times that are non midnight and non whole hours: (62028, 9)
======================================================================

Dimensions of businesses with no & business hours closed modified: (598201, 7)
                              hours_businessOriginal             business_id  \
0  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
1  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
2  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
3  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
4  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   

       hours_business hoursBusiness_day hours_working hours_businessOpen  \
0     Monday: 0:0-0:0            Monday       0:0-0:0               24.0   
1    Tuesday: 0:0-0:0           Tuesday       0:0-0:0               24.0   
2  Wednesday: 0:0-0:0         Wednesday       0:0-0:0               24.0   
3   Thursday: 0:0-0:0          Thursday       0:0-0:0               24.0   
4     Friday: 0:0-0:0            Friday       0:0-0:0               24.0   

  hours_businessClosed  
0                 24.0  
1                 24.0  
2                 24.0  
3                 24.0  
4                 24.0  
======================================================================
                              hours_businessOriginal             business_id  \
0  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
1  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
2  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
3  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   
4  {'Monday': '0:0-0:0', 'Tuesday': '0:0-0:0', 'W...  ENwBByjpoa5Gg7tKgxqwLg   

  hours_businessRegex hoursBusiness_day hours_working hours_businessOpen  \
0     Monday: 0:0-0:0            Monday       0:0-0:0               24.0   
1    Tuesday: 0:0-0:0           Tuesday       0:0-0:0               24.0   
2  Wednesday: 0:0-0:0         Wednesday       0:0-0:0               24.0   
3   Thursday: 0:0-0:0          Thursday       0:0-0:0               24.0   
4     Friday: 0:0-0:0            Friday       0:0-0:0               24.0   

  hours_businessClosed hours_businessOpen_amPM hours_businessClosed_amPM  
0                 24.0                      PM                        PM  
1                 24.0                      PM                        PM  
2                 24.0                      PM                        PM  
3                 24.0                      PM                        PM  
4                 24.0                      PM                        PM  
======================================================================
- Dimensions of businesses with open 24 hours: (42609, 10)
- Dimensions of businesses with open 24 hours: (539512, 10)
======================================================================

Summary - Preprocessing Yelp Reviews for Business Hours:
Number of Rows: 7952263, Columns: 55
                                  Number of Unique Values  \
review_id                                         7952263   
user_id                                           2032516   
business_id                                        106642   
stars_reviews                                           5   
useful_reviews                                        229   
funny_reviews                                         189   
cool_reviews                                          206   
text_reviews                                      7935287   
date_reviews                                      7825308   
name_business                                       79920   
address                                             86334   
city                                                  623   
state                                                  21   
postal_code                                          4667   
latitude                                            96789   
longitude                                           95020   
stars_business                                          9   
review_countbusiness                                 1281   
is_open                                                 2   
attributes_business                                 75159   
categories_business                                 61875   
hours_business                                      38206   
review_count_user                                    1917   
yelping_since_user                                2024363   
useful_user                                          5184   
funny_user                                           3666   
cool_user                                            4363   
elite_user                                           1227   
average_stars_user                                    401   
compliment_hot_user                                  1311   
compliment_more_user                                  349   
compliment_profile_user                               345   
compliment_cute_user                                  315   
compliment_list_user                                  190   
compliment_note_user                                  959   
compliment_plain_user                                1638   
compliment_cool_user                                 1575   
compliment_funny_user                                1575   
compliment_writer_user                                818   
compliment_count_tip_idSum                             23   
compliment_count_tip_businessSum                       27   
businessCheckin_date                               106642   
dateDay_checkinSum                                   2683   
dateYear_checkinSum                                  2683   
dateYearMonth_checkinSum                             2683   
dateYearWeek_checkinSum                              2683   
hours_businessOriginal                              38206   
hours_businessRegex                                  2883   
hoursBusiness_day                                       8   
hours_working                                        1238   
hours_businessOpen                                     86   
hours_businessClosed                                   94   
hours_businessOpen_amPM                                 3   
hours_businessClosed_amPM                               3   
hours_businessOpenDaily                               154   

                                  Number of Missing Values  \
review_id                                                0   
user_id                                                  0   
business_id                                              0   
stars_reviews                                            0   
useful_reviews                                           0   
funny_reviews                                            0   
cool_reviews                                             0   
text_reviews                                             0   
date_reviews                                             0   
name_business                                            0   
address                                                  0   
city                                                     0   
state                                                    0   
postal_code                                              0   
latitude                                                 0   
longitude                                                0   
stars_business                                           0   
review_countbusiness                                     0   
is_open                                                  0   
attributes_business                                      0   
categories_business                                      0   
hours_business                                           0   
review_count_user                                        0   
yelping_since_user                                       0   
useful_user                                              0   
funny_user                                               0   
cool_user                                                0   
elite_user                                               0   
average_stars_user                                       0   
compliment_hot_user                                      0   
compliment_more_user                                     0   
compliment_profile_user                                  0   
compliment_cute_user                                     0   
compliment_list_user                                     0   
compliment_note_user                                     0   
compliment_plain_user                                    0   
compliment_cool_user                                     0   
compliment_funny_user                                    0   
compliment_writer_user                                   0   
compliment_count_tip_idSum                               0   
compliment_count_tip_businessSum                         0   
businessCheckin_date                                     0   
dateDay_checkinSum                                       0   
dateYear_checkinSum                                      0   
dateYearMonth_checkinSum                                 0   
dateYearWeek_checkinSum                                  0   
hours_businessOriginal                                   0   
hours_businessRegex                                      0   
hoursBusiness_day                                        0   
hours_working                                            0   
hours_businessOpen                                       0   
hours_businessClosed                                     0   
hours_businessOpen_amPM                                  0   
hours_businessClosed_amPM                                0   
hours_businessOpenDaily                                  0   

                                 Data type of variable  
review_id                                       object  
user_id                                         object  
business_id                                     object  
stars_reviews                                    int64  
useful_reviews                                   int64  
funny_reviews                                    int64  
cool_reviews                                     int64  
text_reviews                                    object  
date_reviews                            datetime64[ns]  
name_business                                   object  
address                                         object  
city                                            object  
state                                           object  
postal_code                                     object  
latitude                                       float64  
longitude                                      float64  
stars_business                                 float64  
review_countbusiness                             int64  
is_open                                          int64  
attributes_business                             object  
categories_business                             object  
hours_business                                  object  
review_count_user                                int64  
yelping_since_user                              object  
useful_user                                      int64  
funny_user                                       int64  
cool_user                                        int64  
elite_user                                      object  
average_stars_user                             float64  
compliment_hot_user                              int64  
compliment_more_user                             int64  
compliment_profile_user                          int64  
compliment_cute_user                             int64  
compliment_list_user                             int64  
compliment_note_user                             int64  
compliment_plain_user                            int64  
compliment_cool_user                             int64  
compliment_funny_user                            int64  
compliment_writer_user                           int64  
compliment_count_tip_idSum                       int64  
compliment_count_tip_businessSum                 int64  
businessCheckin_date                            object  
dateDay_checkinSum                             float64  
dateYear_checkinSum                            float64  
dateYearMonth_checkinSum                       float64  
dateYearWeek_checkinSum                        float64  
hours_businessOriginal                          object  
hours_businessRegex                             object  
hoursBusiness_day                               object  
hours_working                                   object  
hours_businessOpen                              object  
hours_businessClosed                            object  
hours_businessOpen_amPM                         object  
hours_businessClosed_amPM                       object  
hours_businessOpenDaily                         object  
None
======================================================================

Yelp Reviews EDA
======================================================================

Descriptive statistics of quant vars in Reviews + Business:
       stars_reviews  useful_reviews  funny_reviews  cool_reviews  \
count     7952263.00      7952263.00     7952263.00    7952263.00   
mean            3.73            1.21           0.43          0.51   
std             1.43            3.15           1.90          2.29   
min             1.00            0.00           0.00          0.00   
25%             3.00            0.00           0.00          0.00   
50%             4.00            0.00           0.00          0.00   
75%             5.00            1.00           0.00          0.00   
max             5.00          446.00         610.00        732.00   

       stars_business  review_countbusiness    is_open  
count      7952263.00            7952263.00  7952263.0  
mean             3.73                405.29        0.8  
std              0.69                741.12        0.4  
min              1.00                  5.00        0.0  
25%              3.50                 70.00        1.0  
50%              4.00                183.00        1.0  
75%              4.00                436.00        1.0  
max              5.00               9185.00        1.0  
======================================================================

Percentage of business are open or closed: 
1    80.449414
0    19.550586
Name: is_open, dtype: float64
======================================================================
- Total reviews: 7952263
- Useful reviews: 44%
- Funny reviews: 19%
- Cool reviews: 23%
- Positive reviews: 43%
- Negative reviews: 22%
- OK reviews: 35%
======================================================================
- Percentage of top 30 restaurants: 0.03753753753753754
Average Review Rating of 30 Most Frequent Restaurants
name_business
Salt & Straw                  4.532451
Franklin Barbecue             4.518241
Screen Door                   4.441169
Pine State Biscuits           4.331729
Neptune Oyster                4.308046
Hopdoddy Burger Bar           4.153202
Mike's Pastry                 4.134970
Blue Star Donuts              4.086663
First Watch                   3.844101
Chuy's                        3.803989
Pok Pok                       3.775810
Whole Foods Market            3.612837
Yard House                    3.591885
Voodoo Doughnut - Old Town    3.559333
Shake Shack                   3.462773
Legal Sea Foods               3.425520
Five Guys                     3.397900
Chick-fil-A                   3.351664
Starbucks                     3.121595
The Cheesecake Factory        3.029720
P.F. Chang's                  2.959084
Chipotle Mexican Grill        2.640642
Panera Bread                  2.557238
IHOP                          2.500406
Dunkin'                       2.415180
Buffalo Wild Wings            2.350056
Domino's Pizza                2.215592
Wendy's                       2.181868
Taco Bell                     2.175206
McDonald's                    1.932728
Name: stars_reviews, dtype: float64
======================================================================
Top 10 states with the highest number of reviews:
      state
MA  1891343
TX  1365884
OR  1337624
GA  1084249
FL  1069554
BC   574958
OH   395862
CO   126327
WA   106038
VA      128
======================================================================
Top 30 cities with the highest number of reviews:
Austin               1293078
Portland             1069957
Atlanta               820103
Boston                712427
Orlando               639051
Vancouver             516592
Columbus              271554
Cambridge             211075
Beaverton             106254
Boulder               104945
Somerville             98498
Winter Park            71974
Kissimmee              68705
Decatur                65522
Brookline              62972
Richmond               53284
Lake Buena Vista       49018
Quincy                 45428
Burnaby                40017
Allston                39058
Smyrna                 38376
Tigard                 37791
Salem                  35587
Waltham                34959
Newton                 29590
Sandy Springs          28542
Altamonte Springs      27404
Medford                27171
Watertown              26317
Burlington             26134
Name: city, dtype: int64
======================================================================
Top 30 cities with the highest number of reviews and highest rating
city
Richmond             3.403517
Burnaby              3.408376
Burlington           3.433573
Kissimmee            3.507387
Waltham              3.592923
Quincy               3.611715
Smyrna               3.614290
Medford              3.621140
Tigard               3.621285
Altamonte Springs    3.668698
Atlanta              3.670779
Beaverton            3.674186
Watertown            3.676749
Boston               3.679949
Newton               3.684488
Vancouver            3.689833
Cambridge            3.691764
Allston              3.692483
Lake Buena Vista     3.725081
Decatur              3.731281
Orlando              3.734628
Columbus             3.747446
Salem                3.752606
Sandy Springs        3.758812
Brookline            3.762593
Boulder              3.798752
Somerville           3.809052
Austin               3.823968
Portland             3.923840
Winter Park          3.967877
Name: stars_reviews, dtype: float64
======================================================================

Descriptive statistics of quant vars in Yelp User:
       review_count_user  useful_user  funny_user   cool_user  \
count         7952263.00   7952263.00  7952263.00  7952263.00   
mean              141.96       444.06      218.06      305.08   
std               517.46      3513.48     2340.36     3106.02   
min                 0.00         0.00        0.00        0.00   
25%                 8.00         5.00        1.00        1.00   
50%                28.00        24.00        5.00        5.00   
75%               110.00       131.00       35.00       44.00   
max             15686.00    204380.00   172041.00   198451.00   

       average_stars_user  compliment_hot_user  compliment_more_user  \
count          7952263.00           7952263.00            7952263.00   
mean                 3.74                20.26                  2.94   
std                  0.79               235.80                 52.56   
min                  1.00                 0.00                  0.00   
25%                  3.41                 0.00                  0.00   
50%                  3.83                 0.00                  0.00   
75%                  4.21                 1.00                  1.00   
max                  5.00             25304.00              13501.00   

       compliment_profile_user  compliment_cute_user  compliment_list_user  \
count               7952263.00            7952263.00            7952263.00   
mean                      2.20                  1.58                  1.11   
std                      63.73                 47.93                 42.73   
min                       0.00                  0.00                  0.00   
25%                       0.00                  0.00                  0.00   
50%                       0.00                  0.00                  0.00   
75%                       0.00                  0.00                  0.00   
max                   14180.00              13654.00              12669.00   

       compliment_note_user  compliment_plain_user  compliment_cool_user  \
count            7952263.00             7952263.00            7952263.00   
mean                  15.12                  42.93                 34.22   
std                  138.03                 610.92                391.56   
min                    0.00                   0.00                  0.00   
25%                    0.00                   0.00                  0.00   
50%                    0.00                   0.00                  0.00   
75%                    3.00                   3.00                  3.00   
max                38322.00               90858.00              46858.00   

       compliment_funny_user  compliment_writer_user  
count             7952263.00              7952263.00  
mean                   34.22                   12.94  
std                   391.56                  146.28  
min                     0.00                    0.00  
25%                     0.00                    0.00  
50%                     0.00                    0.00  
75%                     3.00                    2.00  
max                 46858.00                15446.00  
======================================================================
======================================================================
Summary - Preprocessing Yelp Reviews for Category:
Number of Rows: 7952263, Columns: 58
                                  Number of Unique Values  \
review_id                                         7952263   
user_id                                           2032516   
business_id                                        106642   
stars_reviews                                           5   
useful_reviews                                        229   
funny_reviews                                         189   
cool_reviews                                          206   
text_reviews                                      7935287   
date_reviews                                      7825308   
name_business                                       79920   
address                                             86334   
city                                                  623   
state                                                  21   
postal_code                                          4667   
latitude                                            96789   
longitude                                           95020   
stars_business                                          9   
review_countbusiness                                 1281   
is_open                                                 2   
attributes_business                                 75159   
hours_business                                      38206   
review_count_user                                    1917   
yelping_since_user                                2024363   
useful_user                                          5184   
funny_user                                           3666   
cool_user                                            4363   
elite_user                                           1227   
average_stars_user                                    401   
compliment_hot_user                                  1311   
compliment_more_user                                  349   
compliment_profile_user                               345   
compliment_cute_user                                  315   
compliment_list_user                                  190   
compliment_note_user                                  959   
compliment_plain_user                                1638   
compliment_cool_user                                 1575   
compliment_funny_user                                1575   
compliment_writer_user                                818   
compliment_count_tip_idSum                             23   
compliment_count_tip_businessSum                       27   
businessCheckin_date                               106642   
dateDay_checkinSum                                   2683   
dateYear_checkinSum                                  2683   
dateYearMonth_checkinSum                             2683   
dateYearWeek_checkinSum                              2683   
hours_businessOriginal                              38206   
hours_businessRegex                                  2883   
hoursBusiness_day                                       8   
hours_working                                        1238   
hours_businessOpen                                     86   
hours_businessClosed                                   94   
hours_businessOpen_amPM                                 3   
hours_businessClosed_amPM                               3   
hours_businessOpenDaily                               154   
date_reviews_Year                                      18   
date_reviews_YearMonth                                196   
date_reviews_YearWeek                                 853   
categories_combined                                  1067   

                                  Number of Missing Values  \
review_id                                                0   
user_id                                                  0   
business_id                                              0   
stars_reviews                                            0   
useful_reviews                                           0   
funny_reviews                                            0   
cool_reviews                                             0   
text_reviews                                             0   
date_reviews                                             0   
name_business                                            0   
address                                                  0   
city                                                     0   
state                                                    0   
postal_code                                              0   
latitude                                                 0   
longitude                                                0   
stars_business                                           0   
review_countbusiness                                     0   
is_open                                                  0   
attributes_business                                      0   
hours_business                                           0   
review_count_user                                        0   
yelping_since_user                                       0   
useful_user                                              0   
funny_user                                               0   
cool_user                                                0   
elite_user                                               0   
average_stars_user                                       0   
compliment_hot_user                                      0   
compliment_more_user                                     0   
compliment_profile_user                                  0   
compliment_cute_user                                     0   
compliment_list_user                                     0   
compliment_note_user                                     0   
compliment_plain_user                                    0   
compliment_cool_user                                     0   
compliment_funny_user                                    0   
compliment_writer_user                                   0   
compliment_count_tip_idSum                               0   
compliment_count_tip_businessSum                         0   
businessCheckin_date                                     0   
dateDay_checkinSum                                       0   
dateYear_checkinSum                                      0   
dateYearMonth_checkinSum                                 0   
dateYearWeek_checkinSum                                  0   
hours_businessOriginal                                   0   
hours_businessRegex                                      0   
hoursBusiness_day                                        0   
hours_working                                            0   
hours_businessOpen                                       0   
hours_businessClosed                                     0   
hours_businessOpen_amPM                                  0   
hours_businessClosed_amPM                                0   
hours_businessOpenDaily                                  0   
date_reviews_Year                                        0   
date_reviews_YearMonth                                   0   
date_reviews_YearWeek                                    0   
categories_combined                                      0   

                                 Data type of variable  
review_id                                       object  
user_id                                         object  
business_id                                     object  
stars_reviews                                    int64  
useful_reviews                                   int64  
funny_reviews                                    int64  
cool_reviews                                     int64  
text_reviews                                    object  
date_reviews                            datetime64[ns]  
name_business                                   object  
address                                         object  
city                                            object  
state                                           object  
postal_code                                     object  
latitude                                       float64  
longitude                                      float64  
stars_business                                 float64  
review_countbusiness                             int64  
is_open                                          int64  
attributes_business                             object  
hours_business                                  object  
review_count_user                                int64  
yelping_since_user                              object  
useful_user                                      int64  
funny_user                                       int64  
cool_user                                        int64  
elite_user                                      object  
average_stars_user                             float64  
compliment_hot_user                              int64  
compliment_more_user                             int64  
compliment_profile_user                          int64  
compliment_cute_user                             int64  
compliment_list_user                             int64  
compliment_note_user                             int64  
compliment_plain_user                            int64  
compliment_cool_user                             int64  
compliment_funny_user                            int64  
compliment_writer_user                           int64  
compliment_count_tip_idSum                       int64  
compliment_count_tip_businessSum                 int64  
businessCheckin_date                            object  
dateDay_checkinSum                             float64  
dateYear_checkinSum                            float64  
dateYearMonth_checkinSum                       float64  
dateYearWeek_checkinSum                        float64  
hours_businessOriginal                          object  
hours_businessRegex                             object  
hoursBusiness_day                               object  
hours_working                                   object  
hours_businessOpen                              object  
hours_businessClosed                            object  
hours_businessOpen_amPM                         object  
hours_businessClosed_amPM                       object  
hours_businessOpenDaily                         object  
date_reviews_Year                                int64  
date_reviews_YearMonth                       period[M]  
date_reviews_YearWeek                           object  
categories_combined                             object  
None
======================================================================
There are 1067 different categories of Businesses in Yelp



Top 20 categories in Yelp:
Restaurants                  1354633
Food                          452393
Nightlife                     264904
Bars                          228471
American (New)                183332
American (Traditional)        173218
Pizza                         129175
Beauty & Spas                 129045
Sandwiches                    126985
Breakfast & Brunch            126874
Mexican                       126120
Shopping                      114499
Coffee & Tea                  114124
Italian                       110842
Seafood                       102028
Event Planning & Services      98319
Japanese                       94481
Hotels & Travel                81639
Burgers                        80198
Sushi Bars                     79739
Name: categories_combined, dtype: int64
======================================================================
